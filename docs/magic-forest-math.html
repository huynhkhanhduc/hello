<!DOCTYPE html>
<html>
<head>
 
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Magic Forest Math Adventure - A fun, interactive math learning game for kids with multiple difficulty levels and math operations. Practice addition, subtraction, multiplication, and division!">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Magic Forest Math Adventure - Interactive Learning Game">
    <meta property="og:description" content="Help forest animals learn math through fun challenges! Perfect for elementary school students to practice basic math operations.">
    <meta property="og:type" content="website">
<!--     <meta property="og:image" content=""> -->
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Magic Forest Math Adventure">
    <meta name="twitter:description" content="Fun math learning game featuring lovable forest animals and progressive difficulty levels.">
    
    <!-- Keywords and Additional Meta -->
    <meta name="keywords" content="math game, educational game, kids math, elementary math, addition, subtraction, multiplication, division, learning games, math practice">
    <meta name="author" content="Duc Huynh">
    <meta name="theme-color" content="#4ade80">
    
    <!-- App-specific Meta -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Magic Forest Math">
    
    <!-- Robots Meta -->
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    
    <title>Magic Forest Math Adventure - Fun Interactive Math Learning Game for Kids</title>
    
    <!-- Preconnect to External Resources -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://duchuynh.online/magic-forest-math">
    
    <!-- Manifest for PWA -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  
  
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    .character {
      transition: left 0.5s ease;
    }
    .character.hopping {
      animation: hop 0.5s ease;
    }
    @keyframes hop {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }
    .progress-path {
      background: linear-gradient(90deg, #4a5568 50%, #718096 50%);
      background-size: 20px 100%;
    }
    .stone-glow {
      animation: glow 2s infinite;
    }
    @keyframes glow {
      0%, 100% { box-shadow: 0 0 5px #ffd700; }
      50% { box-shadow: 0 0 20px #ffd700; }
    }
  </style>
</head>
<body class="bg-green-50 min-h-screen p-4">
  <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6">
    <!-- Game Header -->
    <div class="text-center mb-6">
      <h1 class="text-3xl font-bold text-green-800">Magic Forest Math</h1>
      
      <!-- Animal Selection -->
      <div class="my-4">
        <div class="grid grid-cols-4 sm:grid-cols-8 gap-2">
          <div class="animal p-2 rounded-lg bg-green-100 cursor-pointer hover:scale-110 transition-transform text-2xl text-center" data-animal="üê®">üê®</div>
          <div class="animal p-2 rounded-lg bg-green-100 cursor-pointer hover:scale-110 transition-transform text-2xl text-center" data-animal="ü¶â">ü¶â</div>
          <div class="animal p-2 rounded-lg bg-green-100 cursor-pointer hover:scale-110 transition-transform text-2xl text-center" data-animal="ü¶í">ü¶í</div>
          <div class="animal p-2 rounded-lg bg-green-100 cursor-pointer hover:scale-110 transition-transform text-2xl text-center" data-animal="üêò">üêò</div>
          <div class="animal p-2 rounded-lg bg-green-100 cursor-pointer hover:scale-110 transition-transform text-2xl text-center" data-animal="ü¶Å">ü¶Å</div>
          <div class="animal p-2 rounded-lg bg-green-100 cursor-pointer hover:scale-110 transition-transform text-2xl text-center" data-animal="üê∏">üê∏</div>
          <div class="animal p-2 rounded-lg bg-green-100 cursor-pointer hover:scale-110 transition-transform text-2xl text-center" data-animal="ü¶ä">ü¶ä</div>
          <div class="animal p-2 rounded-lg bg-green-100 cursor-pointer hover:scale-110 transition-transform text-2xl text-center" data-animal="üêº">üêº</div>
        </div>
      </div>

      <!-- Math Types -->
      <div class="my-4">
        <p class="text-sm text-gray-600 mb-2">Select at least one math type</p>
        <div class="flex flex-wrap justify-center gap-2">
          <button class="math-type px-4 py-2 rounded-lg bg-yellow-100 hover:bg-yellow-200" data-type="+">Addition</button>
          <button class="math-type px-4 py-2 rounded-lg bg-blue-100 hover:bg-blue-200" data-type="-">Subtraction</button>
          <button class="math-type px-4 py-2 rounded-lg bg-purple-100 hover:bg-purple-200" data-type="√ó">Multiplication</button>
          <button class="math-type px-4 py-2 rounded-lg bg-pink-100 hover:bg-pink-200" data-type="√∑">Division</button>
        </div>
      </div>

      <!-- Difficulty -->
      <div class="my-4">
        <div class="flex flex-wrap justify-center gap-2">
          <button class="difficulty px-4 py-2 rounded-lg bg-green-100 hover:bg-green-200" data-level="easy">Easy</button>
          <button class="difficulty px-4 py-2 rounded-lg bg-yellow-100 hover:bg-yellow-200" data-level="medium">Medium</button>
          <button class="difficulty px-4 py-2 rounded-lg bg-orange-100 hover:bg-orange-200" data-level="hard">Hard</button>
          <button class="difficulty px-4 py-2 rounded-lg bg-red-100 hover:bg-red-200" data-level="expert">Expert</button>
        </div>
      </div>
    </div>

    <!-- Game Area -->
    <div class="relative h-20 mb-4">
      <div class="progress-path absolute w-full h-4 rounded-full top-8"></div>
      <div id="character" class="character absolute text-3xl" style="left: 0; top: 0">üê®</div>
      <div class="absolute right-0 top-0 text-3xl">üè†</div>
    </div>

    <!-- Score Area -->
    <div class="flex justify-between items-center mb-4">
      <div class="text-lg font-bold text-green-600">Score: <span id="score">0</span></div>
      <div class="text-lg font-bold text-purple-600">Level: <span id="level">1</span></div>
      <button id="resetBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">Reset</button>
    </div>

    <!-- Problem Area -->
    <div class="bg-green-50 rounded-xl p-6 mb-4">
      <div id="problem" class="text-2xl font-bold text-center mb-4"></div>
      <div id="options" class="grid grid-cols-2 gap-4"></div>
    </div>

    <!-- Stones Collection -->
    <div id="stones" class="flex flex-wrap gap-2"></div>

    <!-- Victory Screen -->
    <div id="victory" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center">
      <div class="bg-white p-6 rounded-xl text-center">
        <h2 class="text-2xl font-bold mb-4">üéâ Victory! üéâ</h2>
        <button onclick="resetGame()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">Play Again</button>
      </div>
    </div>
  </div>

  <script>
    const gameState = {
      score: 0,
      level: 1,
      mathTypes: new Set(['+', '-']),
      difficulty: 'easy',
      character: 'üê®',
      currentAnswer: null,
      difficulties: {
        easy: { maxNum: 10, problems: 5 },
        medium: { maxNum: 20, problems: 8 },
        hard: { maxNum: 50, problems: 10 },
        expert: { maxNum: 100, problems: 15 }
      },
      maxLevels: 5
    };

    function generateNumber(max) {
      return Math.floor(Math.random() * max) + 1;
    }

    function getRandomMathType() {
      const types = Array.from(gameState.mathTypes);
      return types[Math.floor(Math.random() * types.length)];
    }

    function generateProblem() {
      try {
        if (gameState.mathTypes.size === 0) {
          document.getElementById('problem').textContent = 'Please select at least one math type';
          document.getElementById('options').innerHTML = '';
          return;
        }

        const maxNum = Math.min(
          gameState.difficulties[gameState.difficulty].maxNum,
          gameState.difficulties[gameState.difficulty].maxNum * (gameState.level / gameState.maxLevels)
        );
        
        const type = getRandomMathType();
        let num1, num2, answer;

        if (type === '+') {
          num1 = generateNumber(maxNum);
          num2 = generateNumber(maxNum);
          answer = num1 + num2;
        } else if (type === '-') {
          answer = generateNumber(maxNum);
          num2 = generateNumber(maxNum);
          num1 = answer + num2;
        } else if (type === '√ó') {
          num1 = generateNumber(Math.sqrt(maxNum));
          num2 = generateNumber(Math.sqrt(maxNum));
          answer = num1 * num2;
        } else if (type === '√∑') {
          num2 = generateNumber(Math.sqrt(maxNum));
          answer = generateNumber(Math.sqrt(maxNum));
          num1 = num2 * answer;
        }

        gameState.currentAnswer = answer;
        document.getElementById('problem').textContent = `${num1} ${type} ${num2} = ?`;
        generateOptions(answer, type, num2);
      } catch (error) {
        console.error('Error generating problem:', error);
        resetGame();
      }
    }

    function generateOptions(answer, type, num2) {
      const options = new Set([answer]);
      const maxAttempts = 20;
      let attempts = 0;

      while (options.size < 4 && attempts < maxAttempts) {
        let wrong;
        if (type === '+' || type === '-') {
          wrong = answer + (Math.floor(Math.random() * 5) - 2);
        } else if (type === '√ó') {
          wrong = answer + (Math.floor(Math.random() * 3) - 1) * num2;
        } else if (type === '√∑') {
          wrong = answer + Math.floor(Math.random() * 3) - 1;
        }
        
        if (wrong > 0) options.add(wrong);
        attempts++;
      }

      const optionsArray = Array.from(options);
      while (optionsArray.length < 4) {
        optionsArray.push(answer + optionsArray.length);
      }

      document.getElementById('options').innerHTML = optionsArray
        .sort(() => Math.random() - 0.5)
        .map(opt => `
          <button onclick="checkAnswer(${opt})" 
                  class="bg-yellow-100 hover:bg-yellow-200 rounded-lg p-4 text-xl font-bold transition-colors">
            ${opt}
          </button>
        `).join('');
    }

    function checkAnswer(answer) {
      if (answer === gameState.currentAnswer) {
        gameState.score++;
        document.getElementById('score').textContent = gameState.score;
        
        const stone = document.createElement('div');
        stone.className = 'w-6 h-6 rounded-full bg-yellow-400 shadow-lg stone-glow';
        document.getElementById('stones').appendChild(stone);

        const character = document.getElementById('character');
        const progress = (gameState.score / (gameState.maxLevels * gameState.difficulties[gameState.difficulty].problems)) * 100;
        character.style.left = `${Math.min(progress, 100)}%`;
        character.classList.add('hopping');
        setTimeout(() => character.classList.remove('hopping'), 500);

        if (gameState.score % gameState.difficulties[gameState.difficulty].problems === 0) {
          levelUp();
        }

        if (gameState.score >= gameState.maxLevels * gameState.difficulties[gameState.difficulty].problems) {
          document.getElementById('victory').classList.remove('hidden');
          confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
          });
          return;
        }

        generateProblem();
      } else {
        const buttons = document.getElementById('options').children;
        for (let btn of buttons) {
          if (parseInt(btn.textContent) === answer) {
            btn.classList.add('bg-red-200');
            setTimeout(() => btn.classList.remove('bg-red-200'), 500);
          }
        }
      }
    }

    function levelUp() {
      gameState.level = Math.min(gameState.level + 1, gameState.maxLevels);
      document.getElementById('level').textContent = gameState.level;
      confetti({
        particleCount: 50,
        spread: 45,
        origin: { y: 0.6 }
      });
    }

    function resetGame() {
      gameState.score = 0;
      gameState.level = 1;
      document.getElementById('score').textContent = '0';
      document.getElementById('level').textContent = '1';
      document.getElementById('stones').innerHTML = '';
      document.getElementById('character').style.left = '0';
      document.getElementById('victory').classList.add('hidden');
      generateProblem();
    }

    // Event Listeners
    document.querySelectorAll('.animal').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.animal').forEach(b => b.classList.remove('bg-green-300'));
        btn.classList.add('bg-green-300');
        gameState.character = btn.dataset.animal;
        document.getElementById('character').textContent = gameState.character;
      });
    });

    document.querySelectorAll('.math-type').forEach(btn => {
      btn.addEventListener('click', () => {
        const type = btn.dataset.type;
        if (gameState.mathTypes.has(type)) {
          if (gameState.mathTypes.size > 1) {
            gameState.mathTypes.delete(type);
            btn.classList.remove('bg-green-300');
          }
        } else {
          gameState.mathTypes.add(type);
          btn.classList.add('bg-green-300');
        }
        generateProblem();
      });
    });

    document.querySelectorAll('.difficulty').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.difficulty').forEach(b => b.classList.remove('bg-green-300'));
        btn.classList.add('bg-green-300');
        gameState.difficulty = btn.dataset.level;
        resetGame();
      });
    });

    document.getElementById('resetBtn').addEventListener('click', resetGame);

    // Initialize game
    document.querySelector('.animal').classList.add('bg-green-300');
    document.querySelectorAll('.math-type').forEach(btn => {
      if (['+', '-'].includes(btn.dataset.type)) {
        btn.classList.add('bg-green-300');
      }
    });
    document.querySelector('.difficulty').classList.add('bg-green-300');
    generateProblem();
  </script>
</body>
</html>
